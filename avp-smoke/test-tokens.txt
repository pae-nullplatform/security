# ============================================================================
# JWT Tokens para pruebas de seguridad AVP
# Generados: 2026-01-02 18:22:31
# Issuer: https://testing.secure.istio.io
# Secret: test-secret-key-for-smoke-testing (HS256)
# Endpoint: https://hello.pae-infra.nullapps.io/smoke
# ============================================================================

# ----------------------------------------------------------------------
# TOKEN_EXPIRED
# Descripcion: Token expirado - debe dar 401
# Payload: {"sub": "test-user-expired", "iss": "https://testing.secure.istio.io", "iat": 1767388951, "exp": 1767388851}
# ----------------------------------------------------------------------
TOKEN_EXPIRED=eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.eyJzdWIiOiAidGVzdC11c2VyLWV4cGlyZWQiLCAiaXNzIjogImh0dHBzOi8vdGVzdGluZy5zZWN1cmUuaXN0aW8uaW8iLCAiaWF0IjogMTc2NzM4ODk1MSwgImV4cCI6IDE3NjczODg4NTF9.gAyryKlbFTa59EMJRDdoTNXwHIimf6yuls3ENyJ1sZE

# ----------------------------------------------------------------------
# TOKEN_VALID_NO_GROUP
# Descripcion: Token valido sin grupo smoke-testers - GET=200, POST=403
# Payload: {"sub": "test-user-no-group", "iss": "https://testing.secure.istio.io", "iat": 1767388951, "exp": 1767392551, "groups": ["other-group"]}
# ----------------------------------------------------------------------
TOKEN_VALID_NO_GROUP=eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.eyJzdWIiOiAidGVzdC11c2VyLW5vLWdyb3VwIiwgImlzcyI6ICJodHRwczovL3Rlc3Rpbmcuc2VjdXJlLmlzdGlvLmlvIiwgImlhdCI6IDE3NjczODg5NTEsICJleHAiOiAxNzY3MzkyNTUxLCAiZ3JvdXBzIjogWyJvdGhlci1ncm91cCJdfQ.23yUqv8ZwGBRKb_X-K1EGVdeVMJ8V_ZnzGJONkEL1P4

# ----------------------------------------------------------------------
# TOKEN_VALID_SMOKE
# Descripcion: Token valido con grupo smoke-testers - GET/POST=200
# Payload: {"sub": "test-user-smoke", "iss": "https://testing.secure.istio.io", "iat": 1767388951, "exp": 1767392551, "groups": ["smoke-testers"]}
# ----------------------------------------------------------------------
TOKEN_VALID_SMOKE=eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.eyJzdWIiOiAidGVzdC11c2VyLXNtb2tlIiwgImlzcyI6ICJodHRwczovL3Rlc3Rpbmcuc2VjdXJlLmlzdGlvLmlvIiwgImlhdCI6IDE3NjczODg5NTEsICJleHAiOiAxNzY3MzkyNTUxLCAiZ3JvdXBzIjogWyJzbW9rZS10ZXN0ZXJzIl19.xtrucSOzuDLg4adgAzhJs4TkYO41fj4FdER1Un9-QOM

# ----------------------------------------------------------------------
# TOKEN_AUTHENTICATED_ONLY
# Descripcion: Token valido autenticado sin grupos - GET=200
# Payload: {"sub": "test-user-authenticated", "iss": "https://testing.secure.istio.io", "iat": 1767388951, "exp": 1767392551, "groups": []}
# ----------------------------------------------------------------------
TOKEN_AUTHENTICATED_ONLY=eyJhbGciOiAiSFMyNTYiLCAidHlwIjogIkpXVCJ9.eyJzdWIiOiAidGVzdC11c2VyLWF1dGhlbnRpY2F0ZWQiLCAiaXNzIjogImh0dHBzOi8vdGVzdGluZy5zZWN1cmUuaXN0aW8uaW8iLCAiaWF0IjogMTc2NzM4ODk1MSwgImV4cCI6IDE3NjczOTI1NTEsICJncm91cHMiOiBbXX0.Juja6uYONYrLgUfLPx8xWVIbkiqsZBNrI0CJEQ5oZ-E


# ============================================================================
# EJEMPLOS DE USO
# ============================================================================

# Cargar tokens
# source test-tokens.txt

# Prueba sin token (debe dar 401):
# curl -s -o /dev/null -w "%{http_code}" https://hello.pae-infra.nullapps.io/smoke

# Prueba con token expirado (debe dar 401):
# curl -s -o /dev/null -w "%{http_code}" -H "Authorization: Bearer $TOKEN_EXPIRED" https://hello.pae-infra.nullapps.io/smoke

# Prueba GET con token valido sin grupo (debe dar 200):
# curl -s -o /dev/null -w "%{http_code}" -H "Authorization: Bearer $TOKEN_VALID_NO_GROUP" https://hello.pae-infra.nullapps.io/smoke

# Prueba POST con token valido sin grupo smoke-testers (debe dar 403):
# curl -s -o /dev/null -w "%{http_code}" -X POST -H "Authorization: Bearer $TOKEN_VALID_NO_GROUP" https://hello.pae-infra.nullapps.io/smoke

# Prueba GET/POST con token valido con grupo smoke-testers (debe dar 200):
# curl -s -o /dev/null -w "%{http_code}" -H "Authorization: Bearer $TOKEN_VALID_SMOKE" https://hello.pae-infra.nullapps.io/smoke
# curl -s -o /dev/null -w "%{http_code}" -X POST -H "Authorization: Bearer $TOKEN_VALID_SMOKE" https://hello.pae-infra.nullapps.io/smoke
